<?xml version="1.0" encoding="utf-8"?>
<!--
 == ============================================================================
 == | WonderTek [ 网络无处不在，沟通及时到达 ]
 == ============================================================================
 == | Copyright (c) 2012, WonderTek, Inc. All Rights Reserved.
 == ============================================================================
 == | Author: xxxx <xxxx@xxxx.com>
 == ============================================================================
 == | Desc: 页面描述
 == ============================================================================
-->
<root>
    <header/>
    <body resolution="480,800" BuildChildrenFinished="bodyBuildChildrenFinished" OnSpriteEvent="bodyOnSpriteEvent" OnPluginEvent="bodyOnPluginEvent">
        <node name="mainNode" rect="0,0,480,800" enable="true" active="true" OnKeyUp="mainNodeOnKeyUp" layouttype="1" extendstyle="1111">
            <!-- 设置背景 -->
            <image rect="0,0,0,0" src="file://image/backgroundImg.png" style="autosize" extendstyle="1177" />
            <!-- 设置头部 -->
            <node name="baseSprite" rect="0,0,480,66" extendstyle="1111">
                <image name="title" rect="0,0,480,66" border="false"
                    src="file://image/title_new.png" style="autosize" extendstyle="1111">
                    <label rect="0,0,480,66" text="隐患处理" color="#ffffff" v-align="center"
                        h-align="center" font-family="微软雅黑" font-size="30" extendstyle="1111" />
                </image>
                <!-- 返回 -->
                <button name="backBtn" rect="0,0,66,66" normal="" sel="" OnSelect="doBack" extendstyle="1111">
                    <image name="normal" rect="15,10,46,46" src="file://image/title_back_new.png" 
                         extendstyle="1111" />
                    <image name="sel" rect="15,10,46,46" src="file://image/title_back_new.png"
                         extendstyle="1111" />
                </button>
                <!-- 提交 -->
                <button name="submitBtn" rect="400,0,66,66" text="" color="#ffffff"
                    extendstyle="1111" OnSelect="submitOnSelect"
                    font-size="24" >
                    <image name="titleBg1" rect="21,10,46,46" src="file://image/ic_title_upload_new.png"
                    extendstyle="1111"  />
                </button>
            </node>
            <!-- 详情内容 -->
            <listview name="listview" rect="0,66,480,734" col="1"
                extendstyle="1111" limit="true" border="false">
                <list-item rect="0,0,480,52" extendstyle="1111" border="false">
                    <label name="label1" rect="0,0,118,52" border="false" text="上报人："
                        h-align="right" v-align="center" color="#0062ab" font-family="微软雅黑" font-size="24"
                        extendstyle="1111" />
                    <node rect="120,0,292,52" border="false" text="" color="#ffffff"
                        extendstyle="1111">
                        <scrolltext name="shangbaoren" rect="8,0,252,52" text="刘国利" font-family="微软雅黑"
                            color="#303030" font-size="24" h-align="left" v-align="center"
                            scroll="true" style="autosize" extendstyle="1111" >
                        </scrolltext>    
                    </node>
                </list-item>
                <list-item rect="0,0,480,52" extendstyle="1111" border="false">
                    <image name="listButtonImage" rect="0,0,480,52" src="file://image/item_bg.png"
                        extendstyle="1111" style='autosize' />
                    <label name="label1" rect="0,0,118,52" border="false" text="上报时间："
                        h-align="right" v-align="center" color="#0062ab" font-family="微软雅黑" font-size="24"
                        extendstyle="1111" />
                    <node rect="126,0,292,52" border="false" text="" color="#ffffff"
                        extendstyle="1111">
                        <scrolltext name="shangbaoshijian" rect="2,0,252,52" text="2013-02-05 16:31:40" 
                            font-family="微软雅黑" color="#303030" font-size="24" h-align="left" v-align="center" 
                            scroll="true" style="autosize" extendstyle="1111" >
                        </scrolltext>    
                    </node>
                </list-item>
                <list-item rect="0,0,480,52" extendstyle="1111" border="false">
                    <label name="label1" rect="0,0,118,52" border="false" text="处理时间："
                        h-align="right" v-align="center" color="#0062ab" font-family="微软雅黑" font-size="24"
                        extendstyle="1111" />
                    <node rect="120,0,292,52" border="false" text="" color="#ffffff"
                        extendstyle="1111">
                        <scrolltext name="dealtime" rect="8,0,285,52" text="" color="#303030" font-family="微软雅黑"
                            font-size="24" h-align="left" v-align="center" scroll="true" style="autosize"
                            extendstyle="1111">
                        </scrolltext>    
                    </node>
                </list-item>
                <list-item name="textNode" rect="0,0,480,50" extendstyle="1111"
                    border="false">
                    <node name="baseSprite" rect="0,0,480,50" border="false" extendstyle="1111">
                        <image rect="0,0,480,50" src="file://image/search_bg_new.png"
                            style="autosize" extendstyle="1111" />
                        <label name="label1" rect="0,0,150,50" border="false" text="工单处理         "
                            font-family="微软雅黑" font-size="24" color="#303030"  h-align="center"
                            v-align="center" extendstyle="1111" />
                    </node>
                </list-item>
                <list-item rect="0,0,480,52" extendstyle="1111" border="false">
                    <label name="label1" rect="0,0,118,52" border="false" text="处理措施：" 
                        h-align="right"v-align="center" color="#0062ab" font-family="微软雅黑"
                        font-size="24" extendstyle="1111" />
                    <image rect="123,6,220,40" src="file://image/input_text.png"  style="sudoku-auto" sudoku="15,15,15,15" extendstyle="1111" />
                    <button name="dealMeasure" rect="123,6,220,40" border="false" text="" color="#0" >
                        <edit name="dealMeasureContent" rect="5,8,210,40" border="false" text="" font-family="微软雅黑"
                            h-align="left" v-align="top" color="#303030" font-size="24" />
                    </button>
                </list-item>
                <list-item rect="0,0,480,242" extendstyle="1111" border="false">
                    <image name="listButtonImage" rect="0,0,480,52" src="file://image/item_bg.png"
                            extendstyle="1111" style='autosize' />
                    <label name="label1" rect="0,0,118,52" border="false" text="处理结果："
                        h-align="right" v-align="center" color="#0062ab" font-family="微软雅黑" font-size="24"
                        extendstyle="1111" />
                    <image rect="123,6,150,40" src="file://image/select_bg.png"  style="sudoku-auto" sudoku="15,15,15,15"
                        extendstyle="1111">                  
                    </image>
                    <button name="dealResult" rect="123,6,140,40" border="false"
                        text="" color="#0" OnSelect="dealResultOnSelect">
                        <label name="dealResultContent" rect="5,8,130,40" border="false" text=""
                            v-align="top" color="#303030" font-family="微软雅黑" font-size="24" />
                        <label name="dealResultCode" rect="5,8,130,40" border="false" text="" visible="false"
                            v-align="top" color="#303030" font-family="微软雅黑" font-size="24" />
                    </button>
                    <node name="dealOpinionNode" rect="0,67,480,175" extendstyle="1111">
                        <label name="label1" rect="0,10,150,30" border="false" text="结果描述："
                            font-family='微软雅黑' h-align="center" v-align="center" color="#0062ab"
                            font-size="24" extendstyle="1111" />
                        <shadow rect="123,10,322,175" color="#ffffff" alpha="255"
                            border='true' extendstyle="1111" />
                        <edit name="dealOpinionContent" rect="128,15,312,165" font-size="24"
                            font-family='微软雅黑' text="" color="#303030" extendstyle="1111"
                            line-height='28' multiline="true" style="autosize" h-align="left"
                            v-align="top" />
                    </node>
                </list-item>     
                <list-item name="imageListNode" rect="0,0,480,150" extendstyle="1111">
                    <panorama name="imageList" rect="20,15,462,120" extendstyle="0010"
                        style="circle" foreground="foreground" alpha="255" />
                </list-item>
                <!-- 底部菜单栏 -->
                <list-item name="bottomMenuNode" rect="0,0,480,80" style="autosize" extendstyle="1511">
                    <node name="baseSprite" rect="0,0,480,80" style="autosize" extendstyle="1511">
                        <image rect="0,0,480,80" src="file://image/bottom_bg_new.png"
                            style="autosize" extendstyle="1511" />
                        <button name="button1" rect="220,13,54,54" border="false"
                            text="" color="#ffffff" OnSelect="bottomMenuSelect" 
                            extendstyle="1111" data="1">
                            <image rect="0,0,54,54" src="file://image/ic_take_pic_new.png"
                                style="autosize" extendstyle="1111" />
                        </button>
                    </node>
                </list-item>
            </listview>
            <!-- 隐患处理结果列表  -->
            <node name="errorTypeSelectNode" rect="0,0,480,800" visible="false" enable="false">
             <button name="button" rect="0,0,480,800" border="false" text=""
                 color="#ffffff" OnSelect="hideErrorSelected">
             </button>
             <node rect="86,200,368,68" extendstyle="1111"  border="false">
                  <image rect="0,0,368,68" src="file://image/top.png"  style="autosize" extendstyle="1111" />
                  <image rect="20,30,22,22" src="file://image/icon_arrow.png"  style="autosize"  extendstyle="1111" />
                  <label rect="42,7,150,68" border="false" color="#FFFFFF"
                         text="选择处理结果" h-align="center" v-align="center" font-family="微软雅黑" font-size="24"></label>
             </node>   
             <node rect="86,264,368,143" extendstyle="1111" border="false">
                  <image rect="0,0,368,143" src="file://image/center.png"  style="autosize" extendstyle="1111" />
                  <button name="" rect="12,0,342,61" text="    已消除" h-align="left" font-family="微软雅黑"
                          color="#303030" extendstyle="1111" OnSelect="errorTypeOnSelect"
                          font-size="24" data="01">
                          <image rect="285,15,32,32" src="file://image/list_arrow.png"  extendstyle="1111" />
                           <image rect="12,70,320,2" src="file://image/line.png"  style="autosize" extendstyle="0010" />
                          </button>               
                 <button name="" rect="12,73,342,61" text="    未消除" h-align="left" font-family="微软雅黑"
                         color="#303030" extendstyle="1111" OnSelect="errorTypeOnSelect"
                         font-size="24" data="02">
                          <image rect="285,15,32,32" src="file://image/list_arrow.png"  extendstyle="1111" />
                         </button>
             </node>
             <image rect="86,406,368,21" src="file://image/bottom.png"  style="autosize" extendstyle="1111"/>
         </node>
            <!-- 照片布局模版 -->
            <node name="imageListItem" rect="0,0,424,120" extendstyle="1111" visible="false" enable="false" active="false">
                <button name="pic1" rect="0,0,106,120" border="false" text=""
                    color="#ffffff" OnSelect="picOnSelect" extendstyle="1111">
                    <image name="bg" rect="0,7,106,106" src="" style="autosize"
                        extendstyle="1111" />
                    <button rect="79,0,27,26" OnSelect="delPic" normal="src:file://image/pic_delete_d.png;"  
                        sel="src:file://image/pic_delete_s.png;" data="pic1"/>
                </button>
                <button name="pic2" rect="112,0,106,120" border="false" text=""
                    color="#ffffff" OnSelect="picOnSelect" extendstyle="1111">
                    <image name="bg" rect="0,7,106,106" src="" style="autosize"
                        extendstyle="1111" />
                    <button rect="79,0,27,26" OnSelect="delPic" normal="src:file://image/pic_delete_d.png;"  
                        sel="src:file://image/pic_delete_s.png;" data="pic2"/>     
                </button>
                <button name="pic3" rect="224,0,106,120" border="false" text=""
                    color="#ffffff" OnSelect="picOnSelect" extendstyle="1111">
                    <image name="bg" rect="0,7,106,106" src="" style="autosize"
                        extendstyle="1111" />
                    <button rect="79,0,27,26" OnSelect="delPic" normal="src:file://image/pic_delete_d.png;"  
                        sel="src:file://image/pic_delete_s.png;" data="pic3"/>                   
                </button>
                <button name="pic4" rect="336,0,106,120" border="false" text=""
                    color="#ffffff" OnSelect="picOnSelect" extendstyle="1111">
                    <image name="bg" rect="0,7,106,106" src="" style="autosize"
                        extendstyle="1111" />
                    <button rect="79,0,27,26" OnSelect="delPic" normal="src:file://image/pic_delete_d.png;"  
                        sel="src:file://image/pic_delete_s.png;" data="pic4"/>                  
                </button>
            </node>
        </node>
    </body>
    <![CDATA[

require 'com_wondertek_dw.common.framework'
require 'framework.upload'
local rootSprite
local imageArray = {}
local dangerOrderId
local dangerId
local taskid
local curErrorBtn

---------------------------------------callbacks--------------------------------
-- @brief root子节点创建完事件
function bodyBuildChildrenFinished(sprite)
    rootSprite = sprite
end

function bodyOnSpriteEvent(msg, param)
    if msg == MSG_ACTIVATE then -- 页面激活
        local regHandleDangerDetail=Reg:create('dangerOrderDetail')
        dangerOrderId = Reg:getString(regHandleDangerDetail,"dangerOrderId") --隐患工单编号
        taskid = Reg:getString(regHandleDangerDetail,"taskid") --工单流程步骤编号
        dangerId = Reg:getString(regHandleDangerDetail,"dangerId") --隐患编号
        local creatername = Reg:getString(regHandleDangerDetail,"creatername") --上报人
        local createtimedis = Reg:getString(regHandleDangerDetail,"createtimedis") --上报时间
        Log:write("上报人："..creatername..' 上报时间：'..createtimedis)
        Sprite:setProperty(Sprite:findChild(rootSprite, 'shangbaoren'),'text',creatername)
        Sprite:setProperty(Sprite:findChild(rootSprite, 'shangbaoshijian'),'text',createtimedis)
        Sprite:setProperty(Sprite:findChild(rootSprite, 'dealtime'),'text',getCurDealDateAndTime())
    elseif msg == MSG_DEACTIVATE then
    end
end

-- @brief 插件消息方法
function bodyOnPluginEvent(msg)
    if msg == 101 then
        if Loading:isShow() then Loading:close() end
        local updateData = Http:jsonDecode('upload_data')
        Log:write("提交返回数据：", updateData)
        if updateData.code ~= '0' then     
            Dialog:show('',getErrorCode(updateData.code),"ok")
            return
        else
            getUploadUrl()
        end
    elseif msg == 102 then
        local uploadData = Http:xmlDecode('upload_url', 'RESULT')
        Log:write("网达中间件图片上传返回数据uploadData: ", updateData)
        local url = uploadData.URL
        Log:write('网达中间件图片上传返回URL : ', url)
        local param = uploadData.PARAM
        if param then
            param = param .. '&'
        else
            param = ''
        end
        Log:write('网达中间件上传返回参数 : ', param)
        doRealUploadPic(url, param)
    elseif msg == MSG_NETWORK_ERROR then -- 拨号失败
        Log:write('拨号失败')
    elseif msg > MSG_NETWORK_ERROR then -- 请求超时
        Log:write('请求超时')
    end
end

-- @brief 按键响应处理
function mainNodeOnKeyUp(sprite, kc)
    if kc == Key.F2 then -- 按下返回键
        Scene:back()
        return 1
    end
end

---------------------------------------util functions---------------------------
function myfunc()

end
-- 返回函数
function doBack()
    Scene:setReturn(Alias.m_dangerdeal, Alias.m_yinhuangongdanlist.. '?dangerOrderId=' ..dangerOrderId..'&taskid='..taskid)
    Scene:go(Alias.m_yinhuangongdanlist.. '?dangerOrderId=' ..dangerOrderId..'&taskid='..taskid)
end
-- 拍照函数
function bottomMenuSelect(sprite)
    local dataInfo = Sprite:getData(sprite)
    if dataInfo == '1' then
        doTakePic()
    end
end
-- 调摄像头
function doTakePic()
    local fileName = 'ict' .. getCurDate()
    local result = System:openCamera('onCameraDialog', 'file://image/' .. fileName .. '.jpg', 'jpg')
    if result == 0 then
        Dialog:show('提示', '相机打开失败!', 'ok')
        return 1
    end
end
function onCameraDialog(photoPath, photoType)
    -- 添加图片压缩支持
    local tmpSplitArray = Split(photoPath,'%.')
    local dest = tmpSplitArray[1] .. 'temp' .. System:getTickTime() .. '.jpg'
    Log:write('目标文件路径为:'..dest)
    local ret = ScaleImageAsJpg(photoPath, dest, 480, 800, 0)
    if ret == 1 then
        table.insert(imageArray, dest)
        Log:write('图片压缩成功，压缩后的图片位置为:'..dest)
    else
        table.insert(imageArray, photoPath)
        Log:write('警告：图片压缩失败，使用未压缩的图片:'..photoPath)
    end
    Log:write("imageArray", imageArray)
    doChangeImageList()
end
-- 拍照图片布局
function doChangeImageList()
    local count = #imageArray
    local realCount = 0
    if count > 0 then
        if count % 4 > 0 then
            realCount = (count - (count % 4)) / 4 + 1
        else
            realCount = count / 4
        end
    end
    local imageListNode = Sprite:findChild(rootSprite, 'imageListNode')
    local imageList = Sprite:findChild(imageListNode, 'imageList')
    Panorama:removeAllItems(imageList)
    Panorama:loadItem(imageList, Sprite:findChild(rootSprite, 'imageListItem'), realCount, 'loadListItem')
    Panorama:adjust(imageList)
    ListView:adjust(Sprite:getParent(imageListNode))
end
function loadListItem(list, item, index)
    Sprite:setRect(item, 0, 0, 424, 120)
    Sprite:setProperty(item, 'extendstyle', '1111')
    local picArray = {
        Sprite:findChild(item, 'pic1'),
        Sprite:findChild(item, 'pic2'),
        Sprite:findChild(item, 'pic3'),
        Sprite:findChild(item, 'pic4'),
    }
    for i=1,#picArray do
        if imageArray[tonumber(index) * 4 + i] == nil then
            for j=i,#picArray do
                Sprite:setProperty(picArray[j], "enable", "false");
                Sprite:setProperty(picArray[j], "visible", "false");
            end
            break
        end
        Sprite:setProperty(picArray[i], "enable", "true");
        local bg = Sprite:findChild(picArray[i], 'bg')
        if Sprite:getProperty(bg, 'src') ~= nil and Sprite:getProperty(bg, 'src') == '' then
           Sprite:setProperty(bg, 'src', imageArray[tonumber(index) * 4 + i])
           Sprite:setProperty(bg, 'data', imageArray[tonumber(index) * 4 + i])
           Sprite:setProperty(picArray[i], 'data', imageArray[tonumber(index) * 4 + i])
        end
    end
end
--原始只查看原图
function picOnSelect(sprite)
    local igsrc= Sprite:getData(sprite)
    Log:write("隐患工单查看原图传递的照片URL = ",igsrc) 
    --创建数据仓库
    local reg=Reg:create("PicReg")
    Reg:setString(reg, "pic", igsrc)
    --跳转
    Scene:setReturn(Alias.m_dangerdeal, Alias.m_dangerorignImg)
    Scene:go(Alias.m_dangerorignImg,true)
end
--删除图片
function delPic(sprite)
    local key=Sprite:getData(sprite);
    local p=Sprite:findChild(rootSprite, key);
    local bg = Sprite:findChild(p,'bg')
    Sprite:setProperty(bg, "enable", "false");
    Sprite:removeChild(p, bg)
    local dt=Sprite:getData(bg)
    local count=getJsonArrayCount(imageArray)
    for i=1,count-1 do
        if imageArray[i]==dt then
            table.remove(imageArray,i)
            Log:write("删除这个图片之后 imageArray = ",imageArray)
            break
        end
    end
    doChangeImageList()
end
-- 提交隐患处理信息  
function submitOnSelect(sprites)  
    local dealMeasurText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealMeasure'), 'dealMeasureContent'), 'text')
    local dealResultText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealResult'), 'dealResultContent'), 'text')
    local dealOpinionText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealOpinionNode'), 'dealOpinionContent'), 'text')    
    if dealMeasurText and dealMeasurText == '' then
        Dialog:show('提示', '对不起，处理措施为空！', 'ok')
        return
    elseif dealResultText and dealResultText == '' then
        Dialog:show('提示', '对不起，处理结果为空！', 'ok')
        return
    elseif dealOpinionText and dealOpinionText == '' then
        Dialog:show('提示', '对不起，结果描述为空！', 'ok')
        return
    else
        Dialog:show('提示','是否确定提交此隐患？','ok_cancel','doUpload')
    end
end
function doUpload()
    local dealResultCodeText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealResult'), 'dealResultCode'), 'text')
    local dealTimeText = Sprite:getProperty(Sprite:findChild(rootSprite, 'dealtime'), 'text')
    local dealMeasurText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealMeasure'), 'dealMeasureContent'), 'text')
    local dealResultText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealResult'), 'dealResultContent'), 'text')
    local dealOpinionText = Sprite:getProperty(Sprite:findChild(Sprite:findChild(rootSprite, 'dealOpinionNode'), 'dealOpinionContent'), 'text')
    Log:write("处理结果编码："..dealResultCodeText.."，处理时间"..dealTimeText.." ，处理措施："..dealMeasurText.." ，处理结果："..dealResultText.." ，结果描述："..dealOpinionText)
    local url = getUrl()..'nbspweb/webservice/wlbaccident!doWebservice.action'
    local param = '&usercode='.. Config:get('username')..'&id='..dangerId..'&bid='..dangerOrderId..'&dealresult='..dealResultCodeText..'&dealman='..Config:get('username')..'&dealdate='..dealTimeText..'&dealstep='..dealMeasurText..'&remark='..dealOpinionText
    Log:write("单个隐患处理URL = ", url .. '?cmd=wlbaccidentdeal'..param)
    Loading:show(rootSprite)
    Http:request('upload_data', url, 101, {useCache = false, method = 'post', postData='cmd=wlbaccidentdeal'..param})
end
-- 上传拍照图片至服务器
function getUploadUrl()
    -- 如果没有图片和声音，说明已经提交成功，程序返回
    if #imageArray < 1 then
        if Loading:isShow() then Loading:close() end
            Dialog:show('', '隐患提交成功！', 'ok', 'doBack')
            return
    end
    deleleUploadItems()
    -- 请求图片上传队列中的上传地址
    requestPicUrl(imageArray[#imageArray])
end
function requestPicUrl(imageUrl)
    local _,_,fileName = string.find(imageUrl, '([^/\\%.]+)%.?[^/\\]*$')
    local url = getWholeUrl('nbspweb/upload/UGC_GetUploadUrl.html', '')
    local param = 'FILE_NAME=' .. fileName .. '&C_TYPE=' .. 'jpg' .. '&C_LEN=' .. IO:fileSize(imageUrl)
    Log:write("-------------pic url upload------------", url .. param)
    Http:request('upload_url', url, 102, {useCache = false, method = 'post', postData= param})
end
function doRealUploadPic(url, param)
    local _,_,fileName = string.find(imageArray[#imageArray], '([^/\\%.]+)%.?[^/\\]*$')
    local poststr = 'id=' .. dangerId .. '&markid=&interfaceMainType=2&usercode=' .. Config:get('username') .. '&uploadFileName=' .. fileName .. '.jpg'
    Upload:append(url, param .. poststr, imageArray[#imageArray], fileName .. '.jpg', 'test', 'jpg')
    table.remove(imageArray, #imageArray)
    if imageArray[#imageArray] and imageArray[#imageArray] ~= '' then
        requestPicUrl(imageArray[#imageArray])
    else
        if Loading:isShow() then Loading:close() end
        Dialog:show('', '已加入上传队列中！', 'ok', 'doBack')
    end
end
-- 删除上传项
function deleleUploadItems()
    local count = Upload:getCount()
    for i=1,count do
        Upload:delete(i)
    end
end
-- 处理时间
function getCurDealDateAndTime()
    local year = os.date("*t")["year"]
    local month = os.date("*t")["month"]
    local day = os.date("*t")["day"]+1
    local hour = os.date("*t")["hour"]
    local minute = os.date("*t")["min"]
    local sec = os.date("*t")["sec"]
    return string.format('%04s-%02s-%02s %02s:%02s:%02s', year, month, day, hour, minute, sec)
end
-- 处理结果点击函数
function dealResultOnSelect(sprite)
    curErrorBtn = sprite
    setAllShoworHide(Sprite:findChild(rootSprite, 'errorTypeSelectNode'), 1)
end
-- 隐藏处理结果列表
function hideErrorSelected(sprite)
    setAllShoworHide(Sprite:findChild(rootSprite, 'errorTypeSelectNode'), 0)
end
-- 单击列表项函数
function errorTypeOnSelect(sprite)
    local btnData = Sprite:getData(sprite)
    local dealResultContentText = Sprite:findChild(curErrorBtn, 'dealResultContent')
    local dealResultCodeText = Sprite:findChild(curErrorBtn, 'dealResultCode')
    Sprite:setProperty(curErrorBtn, 'data', btnData)
    if btnData == '01' then
        --已消除
        Sprite:setProperty(dealResultContentText, 'text', '已消除')
        Sprite:setProperty(dealResultCodeText, 'text', '1')
    elseif btnData == '02' then
        --未消除
        Sprite:setProperty(dealResultContentText, 'text', '未消除')
        Sprite:setProperty(dealResultCodeText, 'text', '2')
    end
    setAllShoworHide(Sprite:findChild(rootSprite, 'errorTypeSelectNode'), 0)
end



    ]]>
</root>
